(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{Al62:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var l="https://scapi.liziyi0914.com",n={get:e=>fetch(l+e),post:(e,t,a)=>fetch(l+e,{method:"POST",mode:"cors",body:JSON.stringify({token:t,data:a})}),delete:(e,t)=>fetch(l+e,{method:"DELETE",mode:"cors",body:JSON.stringify({token:t})})}},Te3f:function(e,t,a){"use strict";a.r(t);a("5NDa");var l=a("5rEg"),n=(a("y8nQ"),a("Vl3Y")),s=(a("Mwp2"),a("VXEj")),r=(a("IzEo"),a("bx4M")),o=(a("g9YV"),a("wCAj")),i=(a("2qtc"),a("kLXV")),c=(a("+L6B"),a("2/Rp")),m=a("q1tI"),h=a.n(m),d=a("Al62");class p extends h.a.Component{constructor(){super(),this.formA=h.a.createRef(),this.formB=h.a.createRef(),this.columns=[{title:"ID",dataIndex:"id",key:"id",render:(e,t)=>h.a.createElement(c["a"],{type:"link",onClick:()=>{this.setState({selectedProfile:t.id}),this.refresh()}},e)},{title:"\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u5934\u50cf",dataIndex:"avatar",key:"avatar"},{title:"\u8def\u5f84",dataIndex:"path",key:"path"},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",render:(e,t)=>[h.a.createElement(c["a"],{onClick:()=>this.openModalA(t)},"\u7f16\u8f91"),h.a.createElement(c["a"],{type:"primary",onClick:()=>this.askDelA(t),danger:!0},"\u5220\u9664")]}],this.state={showModalA:!1,showModalB:!1,profiles:[],selectedProfile:null,groups:[]}}componentDidMount(){this.refresh()}refresh(){d["a"].get("/profiles").then(e=>e.json()).then(e=>this.setState({profiles:e})),null!=this.state.selectedProfile&&d["a"].get("/group/"+this.state.selectedProfile).then(e=>e.json()).then(e=>this.setState({groups:e}))}openModalA(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,name:"",avatar:"",path:""};this.formA.current.setFieldsValue(e),this.setState({showModalA:!0})}openModalB(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,name:"",profile_id:this.state.selectedProfile};this.formB.current.setFieldsValue(e),this.setState({showModalB:!0})}closeModalA(){this.setState({showModalA:!1})}closeModalB(){this.setState({showModalB:!1})}submitA(e){d["a"].post("/profile/"+e.path,this.props.match.params.token,e).then(e=>e.status).then(e=>{this.closeModalA(),this.refresh()}).catch(console.log)}submitB(e){d["a"].post("/group/"+e.id,this.props.match.params.token,e).then(e=>e.status).then(e=>{this.closeModalB(),this.refresh()}).catch(console.log)}askDelA(e){i["a"].confirm({content:"\u786e\u8ba4\u5220\u9664".concat(e.name,"\uff1f"),okText:"\u5220\u9664",cancelText:"\u53d6\u6d88",okButtonProps:{danger:!0},onOk:()=>{d["a"].delete("/profile/"+e.path,this.props.match.params.token).then(()=>this.refresh())}})}askDelB(e){i["a"].confirm({content:"\u786e\u8ba4\u5220\u9664".concat(e.name,"\uff1f"),okText:"\u5220\u9664",cancelText:"\u53d6\u6d88",okButtonProps:{danger:!0},onOk:()=>{d["a"].delete("/group/"+e.id,this.props.match.params.token).then(()=>this.refresh())}})}render(){return h.a.createElement("div",null,h.a.createElement(r["a"],null,h.a.createElement(o["a"],{columns:this.columns,dataSource:this.state.profiles}),h.a.createElement(c["a"],{type:"primary",onClick:()=>this.openModalA()},"\u6dfb\u52a0")),h.a.createElement("br",null),null!=this.state.selectedProfile&&h.a.createElement(r["a"],null,h.a.createElement(s["a"],{dataSource:this.state.groups,renderItem:e=>h.a.createElement(s["a"].Item,{actions:[h.a.createElement(c["a"],{onClick:()=>this.openModalB(e)},"\u7f16\u8f91"),h.a.createElement(c["a"],{type:"primary",onClick:()=>this.askDelB(e),danger:!0},"\u5220\u9664")]},e.name)}),h.a.createElement(c["a"],{type:"primary",onClick:()=>this.openModalB()},"\u6dfb\u52a0")),h.a.createElement(i["a"],{visible:this.state.showModalA,footer:null,onCancel:()=>this.closeModalA(),forceRender:!0},h.a.createElement(n["a"],{ref:this.formA,onFinish:e=>this.submitA(e)},h.a.createElement(n["a"].Item,{name:"id"}),h.a.createElement(n["a"].Item,{name:"name",label:"\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}]},h.a.createElement(l["a"],null)),h.a.createElement(n["a"].Item,{name:"avatar",label:"\u5934\u50cf",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5934\u50cf\u94fe\u63a5"}]},h.a.createElement(l["a"],null)),h.a.createElement(n["a"].Item,{name:"path",label:"\u8def\u5f84",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8def\u5f84"}]},h.a.createElement(l["a"],null)),h.a.createElement(n["a"].Item,null,h.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),h.a.createElement(c["a"],{onClick:()=>this.closeModalA()},"\u53d6\u6d88")))),h.a.createElement(i["a"],{visible:this.state.showModalB,footer:null,onCancel:()=>this.closeModalB(),forceRender:!0},h.a.createElement(n["a"],{ref:this.formB,onFinish:e=>this.submitB(e)},h.a.createElement(n["a"].Item,{name:"id"}),h.a.createElement(n["a"].Item,{name:"name",label:"\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}]},h.a.createElement(l["a"],null)),h.a.createElement(n["a"].Item,{name:"profile_id"}),h.a.createElement(n["a"].Item,null,h.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),h.a.createElement(c["a"],{onClick:()=>this.closeModalB()},"\u53d6\u6d88")))))}}t["default"]=p}}]);